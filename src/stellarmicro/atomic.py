# AUTO-GENERATED by tools/generate_atomic.py â€” do not edit values by hand.
from __future__ import annotations
from typing import Sequence, Union
from ._np import np

Nmax = 26

chi_ir_full = np.array([2.1787094174619685e-11, 3.939334016449256e-11, 8.718687240377271e-11, 8.638479783778604e-12, 1.211887960068935e-10, 1.9619351292953057e-10, 1.4936610503615164e-11, 2.91774790082691e-11, 2.4656890371227396e-10, 3.4882362901765047e-10, 1.3294892150288045e-11, 4.0302480858242216e-11, 6.077150501183406e-11, 4.155635694920602e-10, 5.451021835282583e-10, 1.804097032571059e-11, 3.906610197808066e-11, 7.672468217013251e-11, 1.0333001078841168e-10, 6.28198333643975e-10, 7.850556683398447e-10, 2.3286243481518417e-11, 4.74264310871925e-11, 7.60157510531202e-11, 1.24126231454199e-10, 1.568372309199234e-10, 8.845095046948979e-10, 1.0687257356228865e-09, 2.1818529521526868e-11, 5.6270237823910074e-11, 8.801643856417237e-11, 1.24030100856159e-10, 1.8248631643596598e-10, 2.212908742937826e-10, 1.1845323962200189e-09, 1.3961526025263142e-09, 2.791443510238788e-11, 5.6029414654053536e-11, 1.0046926032133931e-10, 1.3966974806894998e-10, 1.83047078257866e-10, 2.5180306256877174e-10, 2.967019638852312e-10, 1.528313567472322e-09, 1.7673891314422292e-09, 3.455020371313499e-11, 6.562991339324297e-11, 1.016153293111722e-10, 1.5571554705845998e-10, 2.02269993512598e-10, 2.5303816451415596e-10, 3.32084753105814e-10, 3.83075626659498e-10, 1.9158959567855986e-09, 2.1824838188153845e-09, 8.233709025639751e-12, 7.576110109891224e-11, 1.1474789052708e-10, 1.58512947461424e-10, 2.21747654852136e-10, 2.7594288167381996e-10, 3.3406023689553596e-10, 4.23282249289728e-10, 4.80422276764704e-10, 2.347347704732093e-09, 2.6415122774494086e-09, 1.2250620657249623e-11, 2.4089159882057813e-11, 1.284042032846424e-10, 1.7506247078466359e-10, 2.2643562368322002e-10, 2.9922250816584e-10, 3.6052178618268e-10, 4.2605721921981596e-10, 5.2549791418566e-10, 5.88782289052026e-10, 2.8227226444467068e-09, 3.1445342233513693e-09, 9.590259228321547e-12, 3.01666628621007e-11, 4.5578147304797026e-11, 1.922490195375816e-10, 2.464551411603768e-10, 3.0519862701066e-10, 3.8734222303583995e-10, 4.5604355710176e-10, 5.290547463131399e-10, 6.387077151440999e-10, 7.0817008311117e-10, 3.3421034963090533e-09, 3.6916398446461713e-09, 1.306043122384512e-11, 2.6188938932868898e-11, 5.3661702002562004e-11, 7.232512115493486e-11, 2.67190190722278e-10, 3.28893217250886e-10, 3.9504869264537995e-10, 4.8640480431606e-10, 5.6281260799152e-10, 6.4308165735492e-10, 7.63073472005082e-10, 8.386032828851099e-10, 3.905558769392003e-09, 4.282903262831433e-09, 1.6801523277294923e-11, 3.167421494409666e-11, 4.8389964093113756e-11, 8.242216647653358e-11, 1.0418171186527973e-10, 3.5316779543262e-10, 4.2228569542338e-10, 4.960338858864001e-10, 5.9650638260454e-10, 6.799637634696e-10, 7.6814756540496e-10, 8.9821226455308e-10, 9.801171362597939e-10, 4.513185267207783e-09, 4.9184293547874395e-09, 1.659856595000634e-11, 3.7391406023095914e-11, 5.585187746124e-11, 7.5657985010748e-11, 1.1630921165691299e-10, 1.410762989359386e-10, 4.50137934028836e-10, 5.267860641993959e-10, 6.0857077265856e-10, 7.172944790418e-10, 8.083782206847e-10, 9.042845139959399e-10, 1.04455507830264e-09, 1.132729267178196e-09, 5.165065902397201e-09, 5.598307198330688e-09, 2.077643859088732e-11, 3.8153657578487756e-11, 6.376663003319999e-11, 8.529988399416e-11, 1.0843531458912001e-10, 1.5531500289995998e-10, 1.829706544324242e-10, 5.58047734682004e-10, 6.42234105915534e-10, 7.317140687477999e-10, 8.4915361602e-10, 9.4781565314172e-10, 1.0515085248941998e-09, 1.20200097612582e-09, 1.296478127879532e-09, 5.8613127311940404e-09, 6.322656496884035e-09, 2.5249681947088343e-11, 4.4267611679130776e-11, 6.526466518599e-11, 9.545768385371999e-11, 1.1990689928856e-10, 1.4626270491786e-10, 1.9932679503593998e-10, 2.298429727307478e-10, 6.770798455284e-10, 7.6866026192784e-10, 8.658162530136e-10, 9.91747336446e-10, 1.098292082607e-09, 1.20985164163242e-09, 1.370662110387e-09, 1.47139896624975e-09, 6.602034124825823e-09, 7.0915927818023805e-09, 6.9545100042572846e-12, 5.066883605025e-11, 7.33846565847654e-11, 9.7599794013378e-11, 1.3243592056643998e-10, 1.5932044448496e-10, 1.8835188509304e-10, 2.4812909530758e-10, 2.816905301306316e-10, 8.0696830524678e-10, 9.061911041904e-10, 1.0111336737174e-09, 1.1450756403198e-09, 1.2597914873141998e-09, 1.3793459077432798e-09, 1.5504263287218e-09, 1.6575190192916278e-09, 7.387327463588366e-09, 7.905219284530607e-09, 9.794354854043287e-12, 1.9020590787213847e-11, 8.157187531510343e-11, 1.077835491344088e-10, 1.3512757731156e-10, 1.7428477424652e-10, 2.0381288961113998e-10, 2.3590448759016e-10, 3.0207438257435997e-10, 3.3849986834834997e-10, 9.478476966744e-10, 1.0545526604988e-09, 1.1673458955324e-09, 1.3092987453048e-09, 1.432345910796e-09, 1.5600393885258e-09, 1.7412455658311998e-09, 1.8548815457742841e-09, 8.217335805833319e-09, 8.76368761904359e-09, 1.051266596222466e-11, 2.050749241457418e-11, 3.966482897749992e-11, 1.177429995266796e-10, 1.473201414963e-10, 1.7732890985112e-10, 2.2108435372566e-10, 2.5327208230272003e-10, 2.8843985941902e-10, 3.6077813444412e-10, 4.0022051881993197e-10, 1.10127213114624e-09, 1.2139692355818e-09, 1.3349335714488e-09, 1.484416651401e-09, 1.6159553530524e-09, 1.7519801492789998e-09, 1.9436004747054e-09, 2.063534610996738e-09, 9.092197948122481e-09, 9.667143567393258e-09, 1.0939854318148079e-11, 2.1750348894867e-11, 4.404657539070414e-11, 6.932164879330578e-11, 1.59094537579566e-10, 1.9151297959192198e-10, 2.2539420887112e-10, 2.73171116097e-10, 3.077781313914e-10, 3.4594197881328e-10, 4.2468896037437996e-10, 4.67034488811e-10, 1.26198646930278e-09, 1.384280611776e-09, 1.5132558308129999e-09, 1.6702691409449998e-09, 1.8107800317468e-09, 1.9551361464702e-09, 2.1570104023541998e-09, 2.283513462844938e-09, 1.0012037995057928e-08, 1.0615718331824166e-08, 1.0808583179994557e-11, 2.3446252861955998e-11, 4.69615595368374e-11, 7.4836068397506e-11, 1.0459273425896609e-10, 2.0527888123124998e-10, 2.4148006227648e-10, 2.780577548307e-10, 3.30048386604e-10, 3.69301714137e-10, 4.082346063432e-10, 4.94271491589e-10, 5.38770345421716e-10, 1.435550264064e-09, 1.5656470067448e-09, 1.7029535442786e-09, 1.8668562139368e-09, 2.0169801645426e-09, 2.1696675977628e-09, 2.3819560017678e-09, 2.514866166617904e-09, 1.0977010716902501e-08, 1.1609574148742275e-08, 1.084114421572734e-11, 2.6413972651997373e-11, 4.9601786412005996e-11, 7.876300332743999e-11, 1.1128718899763999e-10, 1.452131190049266e-10, 2.5681289266385996e-10, 2.9601815489783997e-10, 3.35656004823e-10, 3.9173218701299997e-10, 4.338694324872e-10, 4.753658073078e-10, 5.682920520798e-10, 6.15496982247342e-10, 1.6207618829544e-09, 1.7579082028248e-09, 1.903385841192e-09, 2.0744983057032e-09, 2.234235316113e-09, 2.3954142854933997e-09, 2.6181168376194e-09, 2.757639185438022e-09, 1.198726511608316e-08, 1.2648868720393672e-08, 1.1910641979868091e-11, 2.5058026533993656e-11, 5.3942082913511996e-11, 8.204746542714e-11, 1.1601361006793999e-10, 1.5317449491693599e-10, 1.90984261302702e-10, 3.13225531947e-10, 3.5550697331825994e-10, 3.9830111121239996e-10, 4.5838273498740003e-10, 5.037243337296e-10, 5.505078914424e-10, 6.455970746703e-10, 6.97222410171048e-10, 1.8163876499658e-09, 1.9612244176793996e-09, 2.1153538098702e-09, 2.2925545455906e-09, 2.4628659217848e-09, 2.6326966449888e-09, 2.8658133452357998e-09, 3.011888595487482e-09, 1.3042977752464977e-08, 1.3733785015349954e-08, 1.2661149740750375e-11, 2.595399575125914e-11, 4.9108316008733996e-11, 8.797551897294e-11, 1.2016324754999998e-10, 1.5859145411649e-10, 2.4202480233204e-10, 3.7426846170239995e-10, 4.199304957714e-10, 4.660731828306e-10, 5.300000305272e-10, 5.78385764874e-10, 6.283736758548e-10, 7.309129804308e-10, 7.83964253135808e-10, 2.0230684357518e-09, 2.1754354336452e-09, 2.3391778856399997e-09, 2.5243895045303996e-09, 2.702871981558e-09, 2.8813544585856e-09, 3.1248853069536e-09, 3.2776672685952057e-09, 1.4144313970676578e-08, 1.4864495892448171e-08], dtype=float)   # erg
lnG_ir_full = np.array([-0.6931471805599453, 0.6931471805599453, -0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, -1.3862943611198906, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, -0.2231435513142097, -1.3862943611198906, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, 0.22314355131420976, -0.2231435513142097, -1.3862943611198906, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, 1.3862943611198906, 0.22314355131420976, -0.2231435513142097, -1.3862943611198906, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, -0.6931471805599453, 1.3862943611198906, 0.22314355131420976, -0.2231435513142097, -1.3862943611198906, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, 1.3862943611198906, 0.22314355131420976, -0.2231435513142097, -1.3862943611198906, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, 1.3862943611198906, 0.22314355131420976, -0.2231435513142097, -1.3862943611198906, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, 1.3862943611198906, 0.22314355131420976, -0.2231435513142097, -1.3862943611198906, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, -1.3862943611198906, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, 1.3862943611198906, 0.22314355131420976, -0.2231435513142097, -1.3862943611198906, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, -0.2231435513142097, -1.3862943611198906, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, 1.3862943611198906, 0.22314355131420976, -0.2231435513142097, -1.3862943611198906, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, 0.22314355131420976, -0.2231435513142097, -1.3862943611198906, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, 1.3862943611198906, 0.22314355131420976, -0.2231435513142097, -1.3862943611198906, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, 1.3862943611198906, 0.22314355131420976, -0.2231435513142097, -1.3862943611198906, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, 1.3862943611198906, 0.22314355131420976, -0.2231435513142097, -1.3862943611198906, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, -0.6931471805599453, 1.3862943611198906, 0.22314355131420976, -0.2231435513142097, -1.3862943611198906, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, 1.3862943611198906, 0.22314355131420976, -0.2231435513142097, -1.3862943611198906, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, 1.3862943611198906, 0.22314355131420976, -0.2231435513142097, -1.3862943611198906, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, 1.3862943611198906, 0.22314355131420976, -0.2231435513142097, -1.3862943611198906, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, -0.2876820724517809, 0.28768207245178085, -1.3862943611198906, 1.3862943611198906, 0.22314355131420976, -0.2231435513142097, -1.3862943611198906, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, 1.3862943611198906, 0.22314355131420976, -0.2231435513142097, -1.3862943611198906, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, -0.2231435513142097, 0.22314355131420976, -0.2231435513142097, -1.3862943611198906, 1.3862943611198906, 0.22314355131420976, -0.2231435513142097, -1.3862943611198906, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, 1.3862943611198906, 0.22314355131420976, -0.2231435513142097, -1.3862943611198906, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, -1.3862943611198906, 1.3862943611198906, 0.22314355131420976, -0.2231435513142097, -1.3862943611198906, 1.3862943611198906, 0.22314355131420976, -0.2231435513142097, -1.3862943611198906, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, 1.3862943611198906, 0.22314355131420976, -0.2231435513142097, -1.3862943611198906, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, -0.15415067982725836, -1.791759469228055, 1.3862943611198906, 0.22314355131420976, -0.2231435513142097, -1.3862943611198906, 1.3862943611198906, 0.22314355131420976, -0.2231435513142097, -1.3862943611198906, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, 1.3862943611198906, 0.22314355131420976, -0.2231435513142097, -1.3862943611198906, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, 0.15415067982725836, -0.15415067982725836, -1.791759469228055, 1.3862943611198906, 0.22314355131420976, -0.2231435513142097, -1.3862943611198906, 1.3862943611198906, 0.22314355131420976, -0.2231435513142097, -1.3862943611198906, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, 1.3862943611198906, 0.22314355131420976, -0.2231435513142097, -1.3862943611198906, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, 0.10536051565782635, -0.10536051565782628, -0.40546510810816444, -1.791759469228055, 1.3862943611198906, 0.22314355131420976, -1.3862943611198906, 1.3862943611198906, 0.22314355131420976, -0.2231435513142097, -1.3862943611198906, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, 1.3862943611198906, 0.22314355131420976, -0.2231435513142097, -1.3862943611198906, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453, 0.6931471805599453, -0.6931471805599453], dtype=float)   # ln(g_i^r / g_i^(r-1))

i_ir_full   = np.array([1, 2, 2, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 6, 7, 7, 7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8, 8, 8, 9, 9, 9, 9, 9, 9, 9, 9, 9, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26], dtype=int)
r_ir_full   = np.array([1, 1, 2, 1, 2, 3, 1, 2, 3, 4, 1, 2, 3, 4, 5, 1, 2, 3, 4, 5, 6, 1, 2, 3, 4, 5, 6, 7, 1, 2, 3, 4, 5, 6, 7, 8, 1, 2, 3, 4, 5, 6, 7, 8, 9, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 1, 2, 3, 4, 5, 6, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26], dtype=int)
A_ir_full   = np.array([1.008, 4.002602, 4.002602, 6.94, 6.94, 6.94, 9.0121831, 9.0121831, 9.0121831, 9.0121831, 10.81, 10.81, 10.81, 10.81, 10.81, 12.011, 12.011, 12.011, 12.011, 12.011, 12.011, 14.007, 14.007, 14.007, 14.007, 14.007, 14.007, 14.007, 15.999, 15.999, 15.999, 15.999, 15.999, 15.999, 15.999, 15.999, 18.998403163, 18.998403163, 18.998403163, 18.998403163, 18.998403163, 18.998403163, 18.998403163, 18.998403163, 18.998403163, 20.1797, 20.1797, 20.1797, 20.1797, 20.1797, 20.1797, 20.1797, 20.1797, 20.1797, 20.1797, 22.98976928, 22.98976928, 22.98976928, 22.98976928, 22.98976928, 22.98976928, 22.98976928, 22.98976928, 22.98976928, 22.98976928, 22.98976928, 24.305, 24.305, 24.305, 24.305, 24.305, 24.305, 24.305, 24.305, 24.305, 24.305, 24.305, 24.305, 26.9815385, 26.9815385, 26.9815385, 26.9815385, 26.9815385, 26.9815385, 26.9815385, 26.9815385, 26.9815385, 26.9815385, 26.9815385, 26.9815385, 26.9815385, 28.085, 28.085, 28.085, 28.085, 28.085, 28.085, 28.085, 28.085, 28.085, 28.085, 28.085, 28.085, 28.085, 28.085, 30.973761998, 30.973761998, 30.973761998, 30.973761998, 30.973761998, 30.973761998, 30.973761998, 30.973761998, 30.973761998, 30.973761998, 30.973761998, 30.973761998, 30.973761998, 30.973761998, 30.973761998, 32.06, 32.06, 32.06, 32.06, 32.06, 32.06, 32.06, 32.06, 32.06, 32.06, 32.06, 32.06, 32.06, 32.06, 32.06, 32.06, 35.45, 35.45, 35.45, 35.45, 35.45, 35.45, 35.45, 35.45, 35.45, 35.45, 35.45, 35.45, 35.45, 35.45, 35.45, 35.45, 35.45, 39.948, 39.948, 39.948, 39.948, 39.948, 39.948, 39.948, 39.948, 39.948, 39.948, 39.948, 39.948, 39.948, 39.948, 39.948, 39.948, 39.948, 39.948, 39.0983, 39.0983, 39.0983, 39.0983, 39.0983, 39.0983, 39.0983, 39.0983, 39.0983, 39.0983, 39.0983, 39.0983, 39.0983, 39.0983, 39.0983, 39.0983, 39.0983, 39.0983, 39.0983, 40.078, 40.078, 40.078, 40.078, 40.078, 40.078, 40.078, 40.078, 40.078, 40.078, 40.078, 40.078, 40.078, 40.078, 40.078, 40.078, 40.078, 40.078, 40.078, 40.078, 44.955908, 44.955908, 44.955908, 44.955908, 44.955908, 44.955908, 44.955908, 44.955908, 44.955908, 44.955908, 44.955908, 44.955908, 44.955908, 44.955908, 44.955908, 44.955908, 44.955908, 44.955908, 44.955908, 44.955908, 44.955908, 47.867, 47.867, 47.867, 47.867, 47.867, 47.867, 47.867, 47.867, 47.867, 47.867, 47.867, 47.867, 47.867, 47.867, 47.867, 47.867, 47.867, 47.867, 47.867, 47.867, 47.867, 47.867, 50.9415, 50.9415, 50.9415, 50.9415, 50.9415, 50.9415, 50.9415, 50.9415, 50.9415, 50.9415, 50.9415, 50.9415, 50.9415, 50.9415, 50.9415, 50.9415, 50.9415, 50.9415, 50.9415, 50.9415, 50.9415, 50.9415, 50.9415, 51.9961, 51.9961, 51.9961, 51.9961, 51.9961, 51.9961, 51.9961, 51.9961, 51.9961, 51.9961, 51.9961, 51.9961, 51.9961, 51.9961, 51.9961, 51.9961, 51.9961, 51.9961, 51.9961, 51.9961, 51.9961, 51.9961, 51.9961, 51.9961, 54.938044, 54.938044, 54.938044, 54.938044, 54.938044, 54.938044, 54.938044, 54.938044, 54.938044, 54.938044, 54.938044, 54.938044, 54.938044, 54.938044, 54.938044, 54.938044, 54.938044, 54.938044, 54.938044, 54.938044, 54.938044, 54.938044, 54.938044, 54.938044, 54.938044, 55.845, 55.845, 55.845, 55.845, 55.845, 55.845, 55.845, 55.845, 55.845, 55.845, 55.845, 55.845, 55.845, 55.845, 55.845, 55.845, 55.845, 55.845, 55.845, 55.845, 55.845, 55.845, 55.845, 55.845, 55.845], dtype=float)

i_start = np.array([0, 1, 3, 6, 10, 15, 21, 28, 36, 45, 55, 66, 78, 91, 105, 120, 136, 153, 171, 190, 210, 231, 253, 276, 300, 325, 350], dtype=int)

def _as_i_array(i) -> np.ndarray:
    """Return 1D int array of i (atomic numbers)."""
    if np.isscalar(i):
        return np.array([int(i)], dtype=int)
    return np.asarray(i, dtype=int).ravel()

def _slice_for_i(ii: int) -> slice:
    ii = int(ii)
    if ii < 1 or ii > Nmax:
        raise ValueError(f"i must be in [1, {Nmax}]; got i={ii}")
    return slice(int(i_start[ii - 1]), int(i_start[ii]))

def indices_for_i(i) -> np.ndarray:
    """
    Return concatenated flat indices for one i or a list/array of i.
    Example: idx = indices_for_i([1,2,6]); chi_ir[idx]
    """
    ii = _as_i_array(i)
    parts = []
    for a in ii.tolist():
        sl = _slice_for_i(a)
        parts.append(np.arange(sl.start, sl.stop, dtype=int))
    return np.concatenate(parts) if parts else np.array([], dtype=int)

def tables(i=None, idx=None):
    """
    Return all table arrays restricted to either:
      - i (scalar or list), OR
      - explicit flat indices idx

    Returns: chi, lnG, i_list, r_list, A (all 1D arrays)
    """
    if (i is None) == (idx is None):
        raise ValueError("Provide exactly one of: i=... or idx=...")

    if idx is None:
        idx = indices_for_i(i)
    else:
        idx = np.asarray(idx, dtype=int).ravel()

    return (chi_ir_full[idx], lnG_ir_full[idx], i_ir_full[idx], r_ir_full[idx], A_ir_full[idx])

def elements():
    """
    Return per-element arrays (unique i, atomic weights).
    Robust to missing r=1: uses the first available entry for each i.
    """
    i_i_full, first = np.unique(i_ir_full, return_index=True)
    order = np.argsort(i_i_full)
    i_i_full = i_i_full[order]
    first = first[order]
    A_i_full = A_ir_full[first]
    return i_i_full, A_i_full

def neutrals(i=None):
    """
    Return per-element 'neutral' entries, i.e. r=1 (neutral -> first ionisation).

    If i is provided (scalar/list), it restricts to those elements.
    Returns: chi_i1, lnG_i1, i_list, A_i  (all 1D arrays)
    """
    if i is None:
        mask = (r_ir_full == 1)
        idx = np.flatnonzero(mask)
    else:
        idx_i = indices_for_i(i)
        idx = idx_i[r_ir_full[idx_i] == 1]

    # Note: chi/lnG here correspond to the first ionisation step (neutral -> +1)
    return (chi_ir_full[idx], lnG_ir_full[idx], i_ir_full[idx], A_ir_full[idx])

__all__ = [
    'tables', 
    'indices_for_i', 
    'elements', 
    'neutrals'
]
